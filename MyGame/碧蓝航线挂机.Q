[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=cbf0adc5-ece5-4ef1-8fdd-19d535f8969f
Description=碧蓝航线挂机
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[UIPackage]
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


[Script]
'模拟器为bluestacks2，分辨率为1024*768
'************************初始化区域************************* 
'坐标脚本路径
Const COORDINATES_FOLDER_PATH = "C:\QM_Data\碧蓝航线\坐标"

'定义环境变量
DimEnv ENV_FIGHT_INI_PATH

'句柄操作
Hwnd = Plugin.Window.MousePoint()
sRect = Plugin.Window.GetClientRect(Hwnd)  
Dim clientCoordinates	
clientCoordinates = Split(sRect, "|")		'将游戏窗口左上角坐标作为游戏窗口的起始坐标
'将字符串转换为长整型(Long类型,对于坐标来说，参数只能是整型，所以需要转换)
gL = Clng(clientCoordinates(0))
gT = Clng(clientCoordinates(1))  
gR = Clng(clientCoordinates(2))
gB = Clng(clientCoordinates(3))

Const g_LOG_FILE_PATH = "C:\QM_Data\碧蓝航线\log.txt"
If Plugin.File.IsFileExist(g_LOG_FILE_PATH) Then 
    Call Plugin.File.DeleteFile(g_LOG_FILE_PATH)
End If

'换船次数、战斗次数、一些统计数据的定义
g_CHANGE_FLEET_SETTING_TIMES = Int(Form1.ChangeBoatInputBox.Text)
g_TIMES = Int(Form1.FightTimesInputBox.Text)
gFleetNums = Int(Form1.FleetNumsInputBox.Text)
gFightTimes = 0
gAllFightTimes = 0
gRetreatTimes = 0
gHitoutTimes = 0

'战斗章节、关卡位置、起始坐标的定义
Dim mainChapter, mainFightId, mainStarPoint, mianIsShutdown, mainSkipAmbush, mainSkipChooseChapter, mainIsHardFight
mainChapter = Int(ReadFormIni(Split(Form1.ChapterComboBox.List, "|")(Form1.ChapterComboBox.ListIndex), "chapter", ENV_FIGHT_INI_PATH))
mainFightId = Split(Form1.FightIdComboBox.List, "|")(Form1.FightIdComboBox.ListIndex)
mainStarPoint = ReadFormIni("StarPoint", "starPoint", ENV_FIGHT_INI_PATH)
mianIsShutdown = Form1.ShutdownCheckBox.Value
mainSkipAmbush = Form1.SkipAmbushCheckBox.Value
mainSkipChooseChapter = Form1.ChapterSelectCheckBox.Value
mainIsHardFight = Form1.HardFightCheckBox.Value
'************************初始化区域*************************

'************************* 运行区域 ***************************
'自动捞船
Call WriteInTxt(g_LOG_FILE_PATH, "脚本开始运行时间： " & Now())
Call AutoSalvageBoat(mainChapter, mainFightId, mainStarPoint, g_TIMES, mainSkipAmbush)

'是否自动关机
If mianIsShutdown Then 
    Call Plugin.Msg.Tips("准备关机")
    Call WriteInTxt(g_LOG_FILE_PATH, "脚本运行结束时间： " & Now())
    Delay 20 * 1000
    Call Plugin.Sys.ExitOS(1)
End If
'************************** 运行区域 **************************

'************************** 函数声明区域 ****************************
'自动捞船，参数为章节、具体战斗，起始坐标，自动战斗多少轮，是否规避空袭，参考：AutoSalvageBoat(3, "关卡03-04", "起始坐标03-04", g_TIMES, True)
Sub AutoSalvageBoat(chapter, fightId, starPoint, iTimes, isSkipAmbush)
    If mainSkipChooseChapter Then
        Call ChooseChapter(chapter)
    End If
       
    For iTimes
        gHitoutTimes = gHitoutTimes + 1
        gFightTimes = 0
        
        If mainIsHardFight Then 
            Call ChooseHardFight(fightId)
        Else 
            Call ChooseFight(fightId)
        End If
        
        Dim curFleet
        curFleet = CurrentFleet()        
        Do
            Delay 3500
            If CheckIsInFightPnl() Then 
                Call BeginFight(starPoint, isSkipAmbush, curFleet)
                Delay 1000
            ElseIf CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight("Func->AutoSalvageBoat()")
            Else 
                Exit Do
            End If
        Loop
    Next 
End Sub

'选择章节，参数为章节id
Sub ChooseChapter(chapterId)	
    For 8
        Call GameClickByConfig("选择关卡", "上一章", 0, 0)
    Next
    Delay 500
    For Int(chapterId) - 1
        Call GameClickByConfig("选择关卡", "下一章", 0, 0)
    Next
    Delay 1500
End Sub

'选择对应战斗，参数为战斗名
Sub ChooseFight(fightName)
    Call GameClickByConfig("选择关卡", fightName, 0, 0)
    Call GameClickByConfig("选择关卡", "前往关卡", 0, 0)
    Call GameClickByConfig("选择关卡", "确认前往关卡", 0, 0)
End Sub

'选择困难关卡，参数为战斗名
Sub ChooseHardFight(fightName)
    Call GameClickByConfig("选择关卡", fightName, 0, 0)
    Call GameClickByConfig("选择关卡", "前往关卡", 0, 0)
    Call GameClickByConfig("选择关卡", "确认前往困难关卡", 0, 0)	
End Sub

'开始战斗，需要先确定起始坐标，参数为起始坐标，是否跳过空袭，True为跳过
Sub BeginFight(starPoint, isSkipAmbush, iCurFleet)
    '是否整个关卡攻略完成
    If Not CheckIsInFightPnl() Then 
        Call CheckAmbush(isSkipAmbush)
        If Not CheckIsInFightPnl() Then 
            Exit Sub
        End If
    End If

    If CheckIsInEnterFightPnl() Then 
        Call GameClickByConfig("战斗", "开始战斗", 0, 0)
        Call Fight("Func->BeginFight()")
    End If
	
    Dim iOvertimeValue
    iOvertimeValue = 0
    Do
        '是否被空袭
        Call CheckAmbush(isSkipAmbush)                
        '这里需要进行判断是否切换舰队
        If gFightTimes < g_CHANGE_FLEET_SETTING_TIMES Then 
            If FindFleetByPic(iCurFleet) Then
                Call ChangeBoatSetting()
            End If
        Else 
            If Not FindFleetByPic(iCurFleet) Then 
                Call ChangeBoatSetting()
            End If
        End If
           
        '超时判断
        If iOvertimeValue >= 2 And CheckIsInFightPnl() Then 
            Call Retreat()
            Exit Do 
        End If
     
        '检查敌人并进入战斗
        If CheckEnemy(isSkipAmbush) Then 
            Exit Do
        Else 
            Call ChangeBoatSetting()
            Call ChangeBoatSetting()            
            If CheckEnemy(isSkipAmbush) Then 
                Exit Do
            Else 
                If GetPosByConfig("选择关卡", starPoint) <> "" Then 
                    Dim configPos
                    configPos = Split(GetPosByConfig("选择关卡", starPoint), "|")
                    If SearchEnemy(configPos(0), configPos(1), 320, 250) Then 
                        If CheckEnemy(isSkipAmbush) Then 
                            Exit Do
                        End If
                    End If
                End If 
                
                '超时检测，如果超过一定时间还不能检测到敌人，就撤退
                If iOvertimeValue >= 2 And CheckIsInFightPnl() Then 
                    Call Retreat()
                    Exit Do
                End If
            End If
        End If
        iOvertimeValue = iOvertimeValue + 1
    Loop
End Sub

'撤退
Sub Retreat()
    Call GameClickByConfig("战斗", "撤退", 0, 0)
    Call GameClickByConfig("战斗", "撤退确认", 0, 0)
    gRetreatTimes = gRetreatTimes + 1
    Call Plugin.Msg.Tips("我撤退了！次数为：" & gRetreatTimes & "次")
    Call WriteInTxt(g_LOG_FILE_PATH, Now() & " 我撤退了！次数为：" & gRetreatTimes & "次")
End Sub

'返回当前的舰队的舰队名
Function CurrentFleet()
    Dim fleetPicNames
    fleetPicNames = Array("fleet1", "fleet2", "fleet3", "fleet4")
    
    For Each fleetPicName In fleetPicNames
        If GameFindPic(150, 135, 190, 185, "Attachment:\" & fleetPicName & ".bmp", 0.8) Then 
            CurrentFleet = fleetPicName
            Exit Function
        End If	
    Next
    CurrentFleet = ""
    TracePrint "找不到当前舰队，请检查"
End Function

'返回当前的舰队设置，以fleet|fleet2的形式返回
Function FleetSetting()
    Dim iFirstFleet
    iFirstFleet = CurrentFleet()
    FleetSetting = CurrentFleet()
    
    Do
        Call ChangeBoatSetting()
        If FindFleetByPic(iFirstFleet) Then 
            Exit Do
        End If    	
        FleetSetting = FleetSetting & "|" & CurrentFleet()
    Loop
End Function

'通过对应舰队名确认是否为当前舰队
Function FindFleetByPic(picName)
    If GameFindPic(150, 135, 190, 185, "Attachment:\" & picName & ".bmp", 0.8) Then 
        FindFleetByPic = True
    Else 
        FindFleetByPic = False
    End If	
End Function

'检查当前舰队是否为舰队1
Function CheckIsFleet1()
    If GameFindPic(150, 135, 190, 185, "Attachment:\fleet1.bmp", 0.8) Then 
        CheckIsFleet1 = True
    Else 
        CheckIsFleet1 = False
    End If
End Function

'检查当前舰队是否为舰队2
Function CheckIsFleet2()
    If GameFindPic(150, 135, 190, 185, "Attachment:\fleet2.bmp", 0.8) Then 
        CheckIsFleet2 = True
    Else 
        CheckIsFleet2 = False
    End If
End Function

'检查当前舰队是否为舰队3
Function CheckIsFleet3()
    If GameFindPic(150, 135, 190, 185, "Attachment:\fleet3.bmp", 0.8) Then 
        CheckIsFleet3 = True
    Else 
        CheckIsFleet3 = False
    End If
End Function

'检查当前舰队是否为舰队4
Function CheckIsFleet4()
    If GameFindPic(150, 135, 190, 185, "Attachment:\fleet4.bmp", 0.8) Then 
        CheckIsFleet4 = True
    Else 
        CheckIsFleet4 = False
    End If
End Function

'检查敌人进入战斗，参数为是否跳过空袭
Function CheckEnemy(isSkipAmbush)
    Dim isInAmbush, fightType
    
    If FindEnemyPic() <> "" Then 
        picPos = Split(FindEnemyPic(), "|")
        
        fightType = picPos(2)
        Call MoveAndClick(picPos(0), picPos(1), 200, 8000)
        isInAmbush = IsAmbush()
        Call CheckAmbush(isSkipAmbush)
        If CheckIsInEnterFightPnl() Then 
            Call GameClickByConfig("战斗", "开始战斗", 0, 0)
            Call Fight(fightType)
            CheckEnemy = True
        /*
        Else 
            If CheckIsInFightPnl() And (Not isInAmbush) Then 
                For gFleetNums
                    Call GameClickByConfig("战斗", "迎击按钮", 0, 0)
                    If CheckIsInEnterFightPnl() Then 
                        Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                        Call Fight(fightType)
                        CheckEnemy = True
                        Exit For
                    End If
                    Call ChangeBoatSetting()
                Next
            End If
        */
        End If     
        Exit Function
    End If   
    CheckEnemy = False
End Function

'检查是否战斗结束
Function CheckIsFightEnd()
    If GameFindPic(820, 565, 950, 600, "Attachment:\战斗结束确认.bmp", 0.5) Then 
        CheckIsFightEnd = True
    Else 
        CheckIsFightEnd = False
    End If
End Function

'检查是否在战斗关卡选择界面
Function CheckIsInFightPnl()
    If GameFindPic(885, 615, 980, 650, "Attachment:\战斗选择界面.bmp", 0.3) Then 
        CheckIsInFightPnl = True
    Else 
        CheckIsInFightPnl = False
    End If
End Function

'检查是否被空袭，并选择是否迎击，参数为是否迎击
Sub CheckAmbush(isSkipAmbush)
    If IsAmbush() Then 
        If isSkipAmbush Then 
            Call GameClickByConfig("战斗", "空袭规避", 0, 0)
            Delay 3000
            If CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight("Ambush")
            End If    
        Else 
            Call GameClickByConfig("战斗", "空袭迎击", 0, 0)
            Call GameClickByConfig("战斗", "开始战斗", 0, 0)
            Call Fight("Ambush")
        End If
    End If	
End Sub

'检查是否被空袭
Function IsAmbush()
    If GameFindPic(405, 375, 585, 425, "Attachment:\迎击.bmp", 0.5) Then 
		IsAmbush = True
	Else 
	    IsAmbush = False
    End If	
End Function

'检查是否可以点击进入战斗
Function CheckIsInEnterFightPnl()
    If GameFindPic(725, 555, 960, 640, "Attachment:\fight_button.bmp", 0.5) Then 
        CheckIsInEnterFightPnl = True
    Else 
        CheckIsInEnterFightPnl = False
    End If   
End Function

'战斗
Sub Fight(figthType)
    Dim iParm, iCheck
    iParm = 3
    iCheck = 0
    Do
    	'超时检测
        If iCheck >= 100 Then 
            Call WriteInTxt(g_LOG_FILE_PATH, Now() & " 莫名原因退出战斗！")
        	Exit Sub
        End If
        
        Call MoveAndClick(gL + 935, gT + 255, 200, 1500)
        iParm = iParm + 1
        If (iParm mod 3) = 0 Then 
            If CheckIsFightEnd() Then 
                Call GameClickByConfig("战斗", "确认奖励", 0, 0)
                Delay 2000
                Call AmbushMission()
                gFightTimes = gFightTimes + 1
                gAllFightTimes = gAllFightTimes + 1
                Call WriteInTxt(g_LOG_FILE_PATH, Now() & " 出击轮数：" & gHitoutTimes & ", 当前轮数战斗次数：" & gFightTimes & ", 战斗总数：" & gAllFightTimes & ", 战斗类型为：" & figthType)
                Exit Sub
            End If
        End If
        
        iCheck = iCheck + 1
    Loop
End Sub

'紧急任务确认
Sub AmbushMission()
    If GameFindPic(435, 470, 590, 515, "Attachment:\紧急任务.bmp", 0.5) Then 
        Call GameClickByConfig("战斗", "紧急任务确认", 0, 0)
    End If
End Sub

'改舰队设置
Sub ChangeBoatSetting()
    Call GameClickByConfig("战斗", "切换舰队", 0, 0)
    Delay 4500
End Sub

'拖动检查敌人
Function SearchEnemy(starPointX, starPointY, offectX, offectY)
    Call GameMove(starPointX, starPointY, 500)
    LeftDown 1
    Delay 800
    Dim x, y
    For i = 1 To 4
        x = 0
        y = 0   	
        Select Case i
        Case 1
            x = -1
        Case 2
            y = -1
        Case 3
            y = 1
        Case 4
            x = 1
        End Select
    	
        Call GameMove(starPointX + x * offectX, starPointY + y * offectY, 800)
        If FindEnemyPic() <> "" Then 
            LeftUp 1
            SearchEnemy = True
            Exit Function
        End If    	
    Next
    LeftUp 1
    SearchEnemy = False
End Function

'找敌人的图片，返回坐标值，优先找boss
Function FindEnemyPic()
    Dim bossPicName, enemyPicName

    '先找boss的图片
    bossPicName = Array("boss1.bmp", "boss2.bmp")
    For Each bossPic In bossPicName
        FindPic gL + 120, gT + 130, gL + 1024, gT + 620, "Attachment:\" & bossPic, 0.65, intX, intY
        If intX > 0 And intY > 0 Then 
            FindEnemyPic = intX & "|" & intY & "|" & "Boss"
            Exit Function
        End If
    Next 
    
    '再找其他敌人
    enemyPicName = Array("enemy0.bmp", "enemy1.bmp", "enemy2.bmp")	
    For Each enemyPic In enemyPicName
        FindPic gL + 120, gT + 130, gL + 1024, gT + 620, "Attachment:\" & enemyPic, 0.2, intX, intY       
        If intX > 0 And intY > 0 Then 
            FindEnemyPic = intX & "|" & (intY - 25) & "|" & "Normal_enemy"
            Exit Function
        End If
    Next
    FindEnemyPic = ""
End Function

'相对于游戏窗口移动
Sub GameMove(x, y, moveDelay)
    MoveTo gL + x, gT + y
    Delay moveDelay
End Sub

'相对于整个屏幕移动点击
Sub MoveAndClick(x, y, moveDelay, clickDealy)
    MoveTo x, y
    Delay moveDelay
    LeftClick 1
    Delay clickDealy
End Sub

'根据传进来的系统和作用点击坐标，systemName为系统名，forDoWhat为作用，moveDelay为移动后的颜色，clickDealy为点击后的延时，调用函数时2者默认填0，函数会根据表去确定延时，也可以随时更改
Sub GameClickByConfig(systemName, forDoWhat, moveDelay, clickDealy)
    Dim coords, coordArr 
    coords = GetCoordinates(systemName, forDoWhat)
    If coords = "" Then 
        TracePrint "没有对应的按钮配置信息: systemName = " & systemName & " ,  forDoWhat = " & forDoWhat
        EndScript
    End If
    coordArr = Split(coords, "|")
    
    '如果延时传0，则替换表内的默认延时
    If moveDelay = 0 Then 
        moveDelay = coordArr(2)
    End If
    If clickDealy = 0 Then 
        clickDealy = coordArr(3)
    End If
    Call GameMoveAndClick(coordArr(0), coordArr(1), moveDelay, clickDealy)
End Sub

'从配置中获取坐标
Function GetPosByConfig(systemName, forDoWhat)
    Dim text, textArr
    text = GetTxtString(COORDINATES_FOLDER_PATH & "\" & systemName & ".txt")
    textArr = Split(text, "|")
    Dim i
    For i = 0 To UBound(textArr) - 1 Step 5
        If forDoWhat = textArr(i + 4) Then 
            GetPosByConfig = textArr(i) & "|" & textArr(i + 1)
            Exit Function
        End If
    Next
    GetPosByConfig = ""
End Function

'获取对应系统和作用按钮的x，y坐标，移动延时，点击延时（返回以"|"连接的字符串），无则返回空字符串，systemName为系统名，forDoWhat为作用
Function GetCoordinates(systemName, forDoWhat)
    Dim text, textArr
    text = GetTxtString(COORDINATES_FOLDER_PATH & "\" & systemName & ".txt")
    textArr = Split(text, "|")
    Dim i
    For i = 0 To UBound(textArr) - 1 Step 5
        If forDoWhat = textArr(i + 4) Then 
            GetCoordinates = textArr(i) & "|" & textArr(i + 1) & "|" & textArr(i + 2) & "|" & textArr(i + 3)
            Exit Function
        End If
    Next
    GetCoordinates = ""
End Function

'循环输入指令，会读取目标路径txt文件的数据依次输入进行测试,参数为指令文件路径，必须为txt文本, orderStarKwd为开始读取的文本内容
Sub InputOrderFormTxt(orderPath, orderStarKwd)
    Dim tempText, orderArr
    tempText = GetTxtString(orderPath)
    If tempText = "" Then 
        MessageBox "Sub [InputOrderFormTxt(orderPath, orderStarKwd)] error: 读取的文本错误或文本内没有内容"
        EndScript
    End If
    orderArr = Split(tempText, "|")
    Dim i, starIndex
    For i = 0 To ( Ubound( orderArr ))
        If orderArr(i) = orderStarKwd Then 
            starIndex = i
            Exit For
        End If
    Next

    If i >= UBound(orderArr) Then 
        TracePrint "无效的起始指令，请重新输入！"
        ExitScript 
    Else 
        For i = starIndex To (Ubound(orderArr) - 1)
            InputOrder(orderArr(i))
        Next
    End If
End Sub

'相对于游戏窗口坐标进行点击，参数分别为游戏窗口x轴坐标，y轴坐标，点击后的延时
Sub GameMoveAndClick( x, y, moveDelay, clickDelay )
    MoveTo gL + x, gT + y
    Delay moveDelay
    LeftClick 1
    Delay clickDelay
End Sub
 
'获取txt文本内容返回函数调用处，参数为txt文本路径
Function GetTxtString( strPath )
    GetTxtString = Plugin.File.ReadFileEx( strPath )
End Function

Sub WriteInTxt(filePath, wStr)
    Call Plugin.File.WriteFileEx(filePath, wStr)
End Sub

Function ReadFormTxt(filePath)
    ReadFormTxt = Plugin.File.ReadFileEx(filePath)
End Function

Function GameFindPic(x1, y1, x2, y2, picName, picSim)
    FindPic gL + x1, gT + y1, gL + x2, gT + y2, picName, picSim, intX, intY
    If intX > 0 And intY > 0 Then
        GameFindPic = True
    Else 
        GameFindPic = False
    End If
End Function

Function ReadFormIni(subsectionName, keyName, filePath)
    ReadFormIni = Plugin.File.ReadINI(subsectionName, keyName, filePath)
End Function

Sub WriteInIni(subsectionName, keyName, text,filePath)
    Call Plugin.File.WriteINI(subsectionName, keyName, text,filePath)
End Sub

Sub OnScriptExit()
    Call WriteInTxt(g_LOG_FILE_PATH, "脚本运行结束时间： " & Now())
    MessageBox "脚本已经停止！"
End Sub

'各种事件
Event Form1.Load
    ENV_FIGHT_INI_PATH = "C:\QM_Data\碧蓝航线\FightINI.ini"
    Form1.ChapterComboBox.List = ReadFormIni("Chapter", "chapterNums", ENV_FIGHT_INI_PATH)
End Event

Event Form1.ChapterComboBox.SelectChange
    Dim chapter	
    chapter = Split(Form1.ChapterComboBox.List, "|")(Form1.ChapterComboBox.ListIndex)
    Form1.FightIdComboBox.List = ReadFormIni(chapter, "fightId", ENV_FIGHT_INI_PATH)
End Event
'**************************函数声明区域*******************************

'调试数据，先不删
/*
g_CHANGE_FLEET_SETTING_TIMES = 3
g_TIMES = 2
gFightTimes = 0
gAllFightTimes = 0
gRetreatTimes = 0
gHitoutTimes = 0
mainChapter = 3
mainFightId = "关卡03-02"
mainStarPoint = "起始坐标1"
mainSkipAmbush = True
mainSkipChooseChapter = False
mainIsHardFight = False
gFleetNums = 2
*/
