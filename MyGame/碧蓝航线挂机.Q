[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=cbf0adc5-ece5-4ef1-8fdd-19d535f8969f
Description=碧蓝航线挂机
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
'分辨率为1024*768
'************************初始化区域************************* 
'常量定义
'坐标脚本路径
Const COORDINATES_FOLDER_PATH = "C:\QM_Data\碧蓝航线\坐标"

'句柄操作
Hwnd = Plugin.Window.MousePoint()
sRect = Plugin.Window.GetClientRect(Hwnd)  
Dim clientCoordinates	
clientCoordinates = Split(sRect, "|")		'将游戏窗口左上角坐标作为游戏窗口的起始坐标
'将字符串转换为长整型(Long类型,对于坐标来说，参数只能是整型，所以需要转换)
gL = Clng(clientCoordinates(0))
gT = Clng(clientCoordinates(1))  
gR = Clng(clientCoordinates(2))
gB = Clng(clientCoordinates(3))
'************************初始化区域*************************




'************************* 运行区域 ***************************
Const g_CHANGE_FLEET_SETTING_TIMES = 4
Const g_TIMES = 30
Call AutoSalvageBoat(3, "关卡03-04", "起始坐标03-04", g_TIMES)
gFightTimes = 0
gRetreatTimes = 0

//关机
//Plugin.Sys.ExitOS(1)

'************************** 运行区域 **************************
'自动捞船，参数为章节、具体战斗，起始坐标，自动战斗多少轮，参考：AutoSalvageBoat(3, "关卡03-04", "起始坐标03-04", g_TIMES)
Sub AutoSalvageBoat(chapter, fightId, starPoint, iTimes)
    //Call ChooseChapter(chapter)
    For iTimes    
        Call ChooseFight(fightId)
        gFightTimes = 0
        Do
            If CheckIsInFightPnl() Then 
                Call BeginFight(starPoint, True)
                Delay 1000
            ElseIf CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight()
            Else
                Exit Do
            End If
        Loop
    Next 
End Sub
'**************************函数声明区域*******************************
'子程
'选择章节，参数为章节id
Sub ChooseChapter(chapterId)	
    For 8
        Call GameClickByConfig("选择关卡", "上一章", 0, 0)
    Next
    Delay 500
    For Int(chapterId) - 1
        Call GameClickByConfig("选择关卡", "下一章", 0, 0)
    Next
    Delay 1500
End Sub

'选择对应战斗，参数为战斗名
Sub ChooseFight(fightName)
    Call GameClickByConfig("选择关卡", fightName, 0, 0)
    Call GameClickByConfig("选择关卡", "前往关卡", 0, 0)
    Call GameClickByConfig("选择关卡", "确认前往关卡", 0, 0)
End Sub

'开始战斗，需要先确定起始坐标，参数为起始坐标，是否跳过空袭，true为跳过
Sub BeginFight(starPoint, isSkipAmbush)
    '是否整个关卡攻略完成
    If Not CheckIsInFightPnl() Then 
        Call CheckAmbush(isSkipAmbush)
        If Not CheckIsInFightPnl() Then 
            Exit Sub
        End If
    End If

    If CheckIsInEnterFightPnl() Then 
        Call GameClickByConfig("战斗", "开始战斗", 0, 0)
        Call Fight()
    End If
	
    Dim iOvertimeValue
    iOvertimeValue = 0
    Do
        '是否被空袭
        Call CheckAmbush(isSkipAmbush)        
        
        '这里需要进行判断是否切换舰队
        If gFightTimes <= g_CHANGE_FLEET_SETTING_TIMES Then 
            If Not CheckIsFleet2() Then
                TracePrint "第二舰队次数未满，当前为第2舰队，切换舰队"
                Call ChangeBoatSetting()
            End If
        End If
        
        '检查敌人并进入战斗
        If CheckEnemy(isSkipAmbush) Then 
            Exit Do
        Else 
            Call ChangeBoatSetting()
            Call ChangeBoatSetting()
            
            If CheckEnemy(isSkipAmbush) Then 
                Exit Do
            Else 
                Call GameClickByConfig("选择关卡", starPoint, 0, 0)
                
                '防止回到起始坐标时遇到敌人
                If CheckIsInEnterFightPnl() Then 
                    Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                    Call Fight()
                    Exit Do
                End If
                
                '超时检测，如果超过一定时间还不能检测到敌人，就撤退
                If iOvertimeValue >= 2 And CheckIsInFightPnl() Then 
                    Call GameClickByConfig("战斗", "撤退", 0, 0)
                    Call GameClickByConfig("战斗", "撤退确认", 0, 0)
                    gRetreatTimes = gRetreatTimes + 1
                    Call Plugin.Msg.Tips("我撤退了！次数为：" & gRetreatTimes & "次")
                    Exit Do
                End If
            End If
        End If
        iOvertimeValue = iOvertimeValue + 1
    Loop
    TracePrint "跳出循环：" & Time()
End Sub

'检查当前舰队是否为舰队2
Function CheckIsFleet2()
    If GameFindPic(155, 140, 185, 180, "Attachment:\舰队2.bmp", 0.5) Then 
        CheckIsFleet2 = True
    Else 
        CheckIsFleet2 = False
    End If
End Function

'检查敌人进入战斗，参数为是否跳过空袭
Function CheckEnemy(isSkipAmbush)
    Dim enemyPicName
    enemyPicName = Array("enemy0.bmp", "enemy1.bmp")
	
    For Each enemyPic In enemyPicName
        FindPic gL + 120, gT + 130, gL + 950, gT + 595, "Attachment:\enemy0.bmp", 0.1, intX, intY
        If intX > 0 And intY > 0 Then 
            Call MoveAndClick(intX, intY, 200, 8000)
            Call CheckAmbush(isSkipAmbush)
            If CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight()
            End If
            CheckEnemy = True
            Exit Function
        End If
    Next
    CheckEnemy = False
End Function

'检查是否战斗结束
Function CheckIsFightEnd()
    If GameFindPic(820, 565, 950, 600, "Attachment:\战斗结束确认.bmp", 0.5) Then 
        CheckIsFightEnd = True
    Else 
        CheckIsFightEnd = False
    End If
End Function

'检查释放在战斗关卡选择界面
Function CheckIsInFightPnl()
    If GameFindPic(885, 615, 980, 650, "Attachment:\战斗选择界面.bmp", 0.4) Then 
        CheckIsInFightPnl = True
    Else 
        CheckIsInFightPnl = False
    End If
End Function

'检查是否被空袭，并选择是否迎击，参数为是否迎击
Sub CheckAmbush(isSkipAmbush)
    If GameFindPic(405, 375, 585, 425, "Attachment:\迎击.bmp", 0.5) Then 
        TracePrint "进入规避了"
        If isSkipAmbush Then 
            Call GameClickByConfig("战斗", "规避", 0, 0)
            Delay 2000
            If CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight()
            End If    
        Else 
            Call GameClickByConfig("战斗", "迎击", 0, 0)
            Call GameClickByConfig("战斗", "开始战斗", 0, 0)
            Call Fight()
        End If
    End If	
End Sub

'检查是否可以点击进入战斗
Function CheckIsInEnterFightPnl()
    If GameFindPic(725, 555, 960, 640, "Attachment:\fight_button.bmp", 0.7) Then 
        CheckIsInEnterFightPnl = True
    Else 
        CheckIsInEnterFightPnl = False
    End If   
End Function

'战斗
Sub Fight()
    Dim iParm
    iParm = 4
    Do
        Call MoveAndClick(gL + 935, gT + 255, 200, 1800)
        iParm = iParm + 1
        If (iParm mod 4) = 0 Then 
            If CheckIsFightEnd() Then 
                Call GameClickByConfig("战斗", "确认奖励", 0, 0)
                Delay 2000
                Call AmbushMission()
                gFightTimes = gFightTimes + 1
                Exit Sub
            End If
        End If
    Loop
End Sub

'紧急任务确认
Sub AmbushMission()
    If GameFindPic(435, 470, 590, 515, "Attachment:\紧急任务.bmp", 0.5) Then 
        Call GameClickByConfig("战斗", "紧急任务确认", 0, 0)
    End If
End Sub

'改舰队设置
Sub ChangeBoatSetting()
    Call GameClickByConfig("战斗", "切换舰队", 0, 0)
    Delay 5000
End Sub

'移动点击
Sub MoveAndClick(x, y, moveDelay, clickDealy)
    MoveTo x, y
    Delay moveDelay
    LeftClick 1
    Delay clickDealy
End Sub

'根据传进来的系统和作用点击坐标，systemName为系统名，forDoWhat为作用，moveDelay为移动后的颜色，clickDealy为点击后的延时，调用函数时2者默认填0，函数会根据表去确定延时，也可以随时更改
Sub GameClickByConfig(systemName, forDoWhat, moveDelay, clickDealy)
    Dim coords, coordArr 
    coords = GetCoordinates(systemName, forDoWhat)
    If coords = "" Then 
        TracePrint "没有对应的按钮配置信息: systemName = " & systemName & " ,  forDoWhat = " & forDoWhat
        EndScript
    End If
    
    coordArr = Split(coords, "|")
    
    '如果延时传0，则替换表内的默认延时
    If moveDelay = 0 Then 
        moveDelay = coordArr(2)
    End If
    If clickDealy = 0 Then 
        clickDealy = coordArr(3)
    End If
    Call GameMoveAndClick(coordArr(0), coordArr(1), moveDelay, clickDealy)
End Sub

'获取对应系统和作用按钮的x，y坐标，移动延时，点击延时（返回以"|"连接的字符串），无则返回空字符串，systemName为系统名，forDoWhat为作用
Function GetCoordinates(systemName, forDoWhat)
    Dim text, textArr
    text = GetTxtString(COORDINATES_FOLDER_PATH & "\" & systemName & ".txt")
    textArr = Split(text, "|")
    Dim i
    For i = 0 To UBound(textArr) - 1 Step 5
        If forDoWhat = textArr(i + 4) Then 
            GetCoordinates = textArr(i) & "|" & textArr(i + 1) & "|" & textArr(i + 2) & "|" & textArr(i + 3)
            Exit Function
        End If
    Next
    GetCoordinates = ""
End Function


'循环输入指令，会读取目标路径txt文件的数据依次输入进行测试,参数为指令文件路径，必须为txt文本, orderStarKwd为开始读取的文本内容
Sub InputOrderFormTxt(orderPath, orderStarKwd)
    Dim tempText, orderArr
    tempText = GetTxtString(orderPath)
    If tempText = "" Then 
        MessageBox "Sub [InputOrderFormTxt(orderPath, orderStarKwd)] error: 读取的文本错误或文本内没有内容"
        EndScript
    End If
    orderArr = Split(tempText, "|")
    Dim i, starIndex
    For i = 0 To ( Ubound( orderArr ))
        If orderArr(i) = orderStarKwd Then 
            starIndex = i
            Exit For
        End If
    Next

    If i >= UBound(orderArr) Then 
        TracePrint "无效的起始指令，请重新输入！"
        ExitScript 
    Else 
        For i = starIndex To (Ubound(orderArr) - 1)
            InputOrder(orderArr(i))
        Next
    End If
End Sub

'相对于游戏窗口坐标进行点击，参数分别为游戏窗口x轴坐标，y轴坐标，点击后的延时
Sub GameMoveAndClick( x, y, moveDelay, clickDelay )
    MoveTo gL + x, gT + y
    Delay moveDelay
    LeftClick 1
    Delay clickDelay
End Sub
 
'获取txt文本内容返回函数调用处，参数为txt文本路径
Function GetTxtString( strPath )
    GetTxtString = Plugin.File.ReadFileEx( strPath )
End Function

Sub WriteInTxt(filePath, wStr)
    Call Plugin.File.WriteFileEx(filePath, wStr)
End Sub

Function ReadFormTxt(filePath)
    ReadFormTxt = Plugin.File.ReadFileEx(filePath)
End Function

Function GameFindPic(x1, y1, x2, y2, picName, picSim)
    FindPic gL + x1, gT + y1, gL + x2, gT + y2, picName, picSim, intX, intY
    If intX > 0 And intY > 0 Then
        GameFindPic = True
    Else 
        GameFindPic = False
    End If
End Function

'**************************函数声明区域*******************************
/*
        FindPic gL + 120, gT + 130, gL + 950, gT + 595, "Attachment:\enemy0.bmp", 0.1, intX, intY
        If intX > 0 And intY > 0 Then 
            Call MoveAndClick(intX, intY, 200, 8000)
            Call CheckAmbush(isSkipAmbush)
            If CheckIsInEnterFightPnl() Then 
                Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                Call Fight()
            End If
            Exit Do
            
        Else 
            '如果没有界面上没有敌人，先切一下舰队回复一下位置，然后再检查一次，还没有尝试回归起始坐标。
            Call ChangeBoatSetting()
            Call ChangeBoatSetting()
            
            FindPic gL + 120, gT + 130, gL + 950, gT + 595, "Attachment:\enemy0.bmp", 0.1, intX, intY
            If intX > 0 And intY > 0 Then 
                Call MoveAndClick(intX, intY, 200, 8000)
                Call CheckAmbush(isSkipAmbush)
                If CheckIsInEnterFightPnl() Then 
                    Call GameClickByConfig("战斗", "开始战斗", 0, 0)
                    Call Fight()
                End If
                Exit Do
            Else
                Call GameClickByConfig("选择关卡", starPoint, 0, 0)
            End If 
        End If
*/
